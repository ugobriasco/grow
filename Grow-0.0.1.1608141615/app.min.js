var app=angular.module("app",["ngRoute","ui.router","ui.bootstrap","googlechart"]);app.directive("footer",function(){return{restrict:"A",replace:!0,templateUrl:"/shared/partials/footer.view.html"}}),app.directive("navbar",function(){return{restrict:"A",replace:!0,controller:"",templateUrl:"/shared/partials/navbar.view.html"}}),app.directive("navbar1",function(){return{restrict:"A",replace:!0,controller:"PaletteController",templateUrl:"/shared/partials/navbar1.view.html"}}),app.directive("palette",function(){return{restrict:"A",replace:!0,controller:"PaletteController",templateUrl:"/components/palette/palette.view.html"}}),app.directive("balancesheet",function(){return{restrict:"A",replace:!0,controller:"BalanceSheetController",templateUrl:"/components/results/partials/results.balanceSheet.view.html"}}),app.directive("kpi",function(){return{restrict:"A",replace:!0,controller:"KpiController",templateUrl:"/components/results/partials/results.kpi.view.html"}}),app.directive("graphs",function(){return{restrict:"A",replace:!0,controller:"GraphsController",templateUrl:"/components/results/partials/results.graphs.view.html"}}),app.directive("statement",function(){return{restrict:"A",replace:!0,controller:"StatementController",templateUrl:"/components/results/partials/results.statement.view.html"}}),app.config(["$stateProvider","$urlRouterProvider","$locationProvider",function(a,b,c){c.html5Mode({enabled:!1,requireBase:!1}),a.state("home",{url:"",templateUrl:"/components/home/home.view.html",controller:"HomeController",caseInsensitiveMatch:!0}).state("results",{url:"/results",templateUrl:"/components/results/results.view.html",controller:"ResultsController",caseInsensitiveMatch:!0})}]),app.controller("HomeController",["$scope","$state",function(a,b){a.calculateResult=function(){return b.go("results")}}]),app.controller("PaletteController",["$scope","$state","$uibModal",function(a,b,c){a.openInput=function(a){c.open({templateUrl:"./components/palette/modals/datainput.view.html",controller:"InputController",size:a})},a.openConfigurations=function(a){c.open({templateUrl:"./components/palette/modals/configurations.view.html",controller:"ConfigurationsController",size:a})},a.openStrategy=function(a){c.open({templateUrl:"./components/palette/modals/strategy.view.html",controller:"StrategyController",size:a})}}]),app.controller("InputController",["$scope","$uibModalInstance","MrrCalc",function(a,b,c){a.data=c.getBalanceSheet(),a.addRow=function(){a.data.costs.push({})},a.removeRow=function(b){a.data.costs.splice(b,1)},a.submit=function(a,d,e){c.setCurrency(a),c.setMRR(d),c.setMRC(e),c.getBalanceSheet(),b.dismiss("close")},a.cancel=function(){b.dismiss("close")}}]),app.controller("ConfigurationsController",["$scope","$uibModalInstance","MrrCalc",function(a,b,c){a.data=c.getBalanceSheet(),a.submit=function(a,d){c.setMonthlyChurn(a),c.setGEI(d),c.getBalanceSheet(),b.dismiss("close")},a.cancel=function(){b.dismiss("close")}}]),app.controller("StrategyController",["$scope","$uibModalInstance","MrrCalc",function(a,b,c){a.data=c.getBalanceSheet(),a.submit=function(a){c.setMonthlyCAC(a),c.getBalanceSheet(),b.dismiss("close")},a.cancel=function(){b.dismiss("close")}}]),app.controller("ResultsController",["$scope","MrrCalc",function(a,b){}]),app.controller("BalanceSheetController",["$scope","MrrCalc",function(a,b){a.data=b.getBalanceSheet(),a.detailsToggle="false"}]),app.controller("KpiController",["$scope","MrrCalc",function(a,b){a.data=b.getBalanceSheet(),a.$watch(function(){a.kpi=b.getKPI()})}]),app.controller("StatementController",["$scope","MrrCalc",function(a,b){}]),app.controller("GraphsController",["$scope","MrrCalc",function(a,b){a.data=b.getBalanceSheet(),a.myChartObject={},a.myChartObject.type="ColumnChart";var c=[{v:"Now"},{v:0},{v:0}],d=[{v:"1mo+"},{v:0},{v:0}],e=[{v:"2mo+"},{v:0},{v:0}],f=[{v:"3mo+"},{v:0},{v:0}],g=[{v:"4mo+"},{v:0},{v:0}],h=[{v:"5mo+"},{v:0},{v:0}],i=[{v:"6mo+"},{v:0},{v:0}],j=[{v:"7mo+"},{v:0},{v:0}],k=[{v:"8mo+"},{v:0},{v:0}],l=[{v:"9mo+"},{v:0},{v:0}],m=[{v:"10mo+"},{v:0},{v:0}],n=[{v:"11mo+"},{v:0},{v:0}],o=[{v:"12mo+"},{v:0},{v:0}];a.myChartObject.data={cols:[{id:"t",label:"Time",type:"string"},{id:"s",label:a.data.currency,type:"number"},{id:"u",label:"capital",type:"number"}],rows:[{c:c},{c:d},{c:e},{c:f},{c:g},{c:h},{c:i},{c:j},{c:k},{c:l},{c:m},{c:n},{c:o}]},a.$watch(function(){c[1].v=a.data.mrr,d[1].v=a.data.projection[0],e[1].v=a.data.projection[1],f[1].v=a.data.projection[2],g[1].v=a.data.projection[3],h[1].v=a.data.projection[4],i[1].v=a.data.projection[5],j[1].v=a.data.projection[6],k[1].v=a.data.projection[7],l[1].v=a.data.projection[8],m[1].v=a.data.projection[9],n[1].v=a.data.projection[10],o[1].v=a.data.projection[11],c[2].v=a.target,d[2].v=a.target,e[2].v=a.target,f[2].v=a.target,g[2].v=a.target,h[2].v=a.target,i[2].v=a.target,j[2].v=a.target,k[2].v=a.target,l[2].v=a.target,m[2].v=a.target,n[2].v=a.target,o[2].v=a.target}),a.myChartObject.options={title:"MRR Projection",titleTextStyle:{color:"#6EAF19",fontSize:16},backgroundColor:"#555555",legend:"none",series:{0:{type:"column",color:"#6EAF19"},1:{type:"line",color:"#e2431e"}},colors:["#6EAF19","#E2B400","#DF0000","#DF0000","#DF0000","#DF0000","#DF0000"],hAxis:{textStyle:{color:"#6EAF19",fontSize:13,bold:!1},gridlines:{color:"#6EAF19"},textPosition:"center"},vAxis:{textStyle:{color:"#6EAF19",fontSize:13,bold:!1},format:"#",gridlineColor:"#6EAF19",gridlines:{color:"#6EAF19"},textPosition:"center"}}}]),app.service("MrrCalc",[function(){var a={currency:"â‚¬",mrr:100,mrc:30,churn:1,cac:0,gei:.8,mcv:0},b={gei:{success:0,warning:0},rpm:{success:0,warning:0},churn:{success:0,warning:0}},c=function(b){a.currency=b},d=function(b){a.mrr=b},e=function(b){a.mrc=b},f=function(b){a.churn=b},g=function(b){a.cac=b},h=function(b){a.gei=b},j=function(a,b){var c=a-b;return c},k=function(a,b){var c=a-b;return c},l=function(a,b){var c=0;if(b>0)var c=a/b;return c},m=function(a,b){var c=a-b;return c},n=function(a,b,c){var d=a-b+c;return d},o=function(){return a.churnIndex=a.churn/a.mrr,a.rpmIndex=a.rpm/a.mrr,a.mrrIndex=(a.mrr_next-a.mrr)/a.mrr,a.incomeIndex=a.income/a.rpm,a.cacIndex=a.cac/a.rpm,a},p=function(b){var c=[],d=a.mrr;for(i=0;i<b;i++){var e=n(d,a.churn,a.mcv);c.push(e),d=e}a.projection=c},q=function(){return a.rpm>0&&a.churn>0?(b.gei.warning=a.rpm/a.churn,b.gei.success=1):(b.gei.warning=2,b.gei.success=1),b},r=function(){return a.churn>0&&a.gei>0?(b.rpm.warning=a.churnIndex*a.gei,b.rpm.success=.5):(b.rpm.warning=0,b.rpm.success=.5),b},s=function(){return a.rpm>0&&a.gei>0?(b.churn.warning=a.rpmIndex/a.gei,b.churn.success=.1):(b.churn.warning=.3,b.churn.success=.1),b},t=function(){return a.net_mrr=j(a.mrr,a.churn),a.rpm=k(a.net_mrr,a.mrc),a.mcv=l(a.cac,a.gei),a.income=m(a.rpm,a.cac),a.mrr_next=n(a.mrr,a.churn,a.mcv),a=o(),p(12),a},u=function(){return q(),r(),s(),b};return{setCurrency:c,setMRR:d,setMRC:e,setMonthlyChurn:f,setMonthlyCAC:g,setGEI:h,getBalanceSheet:t,getKPI:u}}]);